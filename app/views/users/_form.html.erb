<%= form_with(model: user, local: true ) do |form| %>
  <% if user.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(user.errors.count, "error") %> prohibited this user from being updated:</h2>
      <ul>
      <% user.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <fieldset class="mt-4">
    <legend>User details</legend>
  <div class="row">
    <div class="col-lg-6">
      <div class="form-group">
        <%= form.label :email %>
        <%= form.text_field :email, id: :user_email, class: "form-control" %>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-lg-6">
      <div class="form-group">
        <%= form.label :first_name %>
        <%= form.text_field :first_name, id: :user_first_name,
          class: "form-control" %>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-lg-6">
      <div class="form-group">
        <%= form.label :last_name %>
        <%= form.text_field :last_name, id: :user_last_name,  class: "form-control" %>
      </div>
    </div>
  </div>
  <div class="row ml-2">
    <div class="col-lg-6">
      <div class="form-check">
        <%= form.check_box :enabled, id: :user_enabled, class: "form-check-input" %>
        <%= form.label :enabled, class: 'form-check-label' %>
      </div>
    </div>
  </div>
  </fieldset>
  <div class="row">
  <fieldset class="col-lg-3 col-sm-6 mt-4">
    <legend>Role</legend>
    <div class="row ml-2">
      <div class="col">
        <% @user.defined_enums['role'].each do |k, _| %>
          <div class="form-check">
            <%= form.radio_button :role, k, id: "role_#{k}", class: "form-check-input" %>
            <%= form.label :role, role_label(k), for: "role_#{k}", class: 'form-check-label' %>
          </div>
        <% end %>
      </div>
    </div>
  </fieldset>
  <fieldset class="col-lg-3 col-sm-6 mt-4">
    <legend>Regime Access</legend>
  <%= form.fields_for :regime_users do |ff| %>
    <%= ff.hidden_field :regime_id %>
    <div class="row ml-2">
      <div class="col">
        <div class="form-check">
          <%= ff.check_box :enabled, class: "form-check-input" %>
          <%= ff.label :enabled, ff.object.regime.title, class: 'form-check-label' %>
        </div>
      </div>
    </div>
  <% end %>
  </fieldset>
  </div>
  <div class="row mt-4 mb-4">
    <div class="col-lg-6 actions">
      <%= user_submit_button(form) %>
      <% if user.persisted? %>
        <%= link_to 'Resend Invitation', reinvite_user_path(user),
          class: 'btn btn-warning', role: 'button' %>
      <% end %>
      <%= link_to 'Cancel', users_path, class: 'ml-4 btn btn-secondary', role: 'button' %>
    </div>
  </div>
<% end %>
